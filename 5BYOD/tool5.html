<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student BYOD Guide</title>
    <meta property="og:title" content="Student BYOD Guide" />
    <meta property="og:description" content="Get setup with the basics to get your BYOD device working at school!" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://checker.fauxprojects.xyz" />
    <!-- <meta property="og:image" content="https://checker.fauxprojects.xyz/image.jpeg" /> -->
    <style>
        :root {
            /* Base theme colors - Light Mode */
            --background-color: #f8fafc;
            --text-color: #1f2937;
            --card-background: white;
            --border-color: #e5e7eb;
            --shadow-color: rgba(0, 0, 0, 0.1);

            /* Certificate colors - Light Mode */
            --cert-primary: #60a5fa;
            --cert-secondary: #3b82f6;
            --cert-bg: #dbeafe;

            /* PaperCut colors - Light Mode */
            --papercut-primary: #f97316;
            --papercut-secondary: #ea580c;
            --papercut-bg: #ffedd5;

            /* Office colors - Light Mode */
            --office-primary: #8b5cf6;
            --office-secondary: #7c3aed;
            --office-bg: #f3e8ff;

            /* FAQ colors - Light Mode */
            --faq-bg: white;
            --faq-border: #e5e7eb;
            --faq-hover: #f8fafc;

            /* FAQ header colors */
            --faq-program-color: #ffafcc;
            /* Soft pastel blue */
            --faq-technical-color: #57cc99;
            /* Soft pastel purple/thistle */

            --error-bg: #fee2e2;
            --error-border: #dc2626;
            --error-text: #111827;
            --error-heading: #dc2626;
        }

        @media (prefers-color-scheme: dark) {
            :root {
                /* Base theme colors - Dark Mode */
                --background-color: #1a1a1a;
                --text-color: #e5e7eb;
                --card-background: #2d2d2d;
                --border-color: #404040;
                --shadow-color: rgba(0, 0, 0, 0.3);

                /* Certificate colors - Dark Mode */
                --cert-primary: #3b82f6;
                --cert-secondary: #2563eb;
                --cert-bg: rgba(59, 130, 246, 0.1);

                /* PaperCut colors - Dark Mode */
                --papercut-primary: #f97316;
                --papercut-secondary: #ea580c;
                --papercut-bg: rgba(249, 115, 22, 0.1);

                /* Office colors - Dark Mode */
                --office-primary: #8b5cf6;
                --office-secondary: #7c3aed;
                --office-bg: rgba(139, 92, 246, 0.1);

                /* FAQ colors - Dark Mode */
                --faq-bg: #2d2d2d;
                --faq-border: #404040;
                --faq-hover: #363636;

                --faq-program-color: #ffafcc;
                /* Soft pastel blue */
                --faq-technical-color: #57cc99;
                /* Soft pastel purple/thistle */

                --error-bg: #2d1f1f;
                --error-border: #dc2626;
                --error-text: #e5e7eb;
                --error-heading: #fca5a5;
            }
        }

        .site-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 24px;
        }

        .site-title {
            margin: 0;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .school-logo {
            height: 48px;
            width: auto;
            object-fit: contain;
        }

        .school-logo.hidden {
            display: none;
        }


        /* Ensure unsupported notice stays distinct */
        #unsupported-notice {
            background-color: var(--error-bg) !important;
            border-left-color: var(--error-border) !important;
        }

        #unsupported-notice .section-content h2 {
            color: var(--error-heading);
        }

        #unsupported-notice .section-content p,
        #unsupported-notice .section-content ul {
            color: var(--error-text);
        }

        #unsupported-notice .section-content ul {
            margin-top: 1rem;
            padding-left: 1.5rem;
        }

        #unsupported-notice .section-content ul li {
            margin-bottom: 0.5rem;
        }

        #unsupported-notice .section-content ul li:last-child {
            margin-bottom: 0;
        }

        body {
            font-family: system-ui, -apple-system, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        h1,
        h2,
        h3 {
            margin-top: 0;
        }

        .faq-answer ol {
            padding-left: 2.5rem;
            margin: 1rem 0;
        }

        .faq-answer ol li {
            padding-left: 0.5rem;
            margin-bottom: 0.75rem;
        }

        .faq-answer ol li:last-child {
            margin-bottom: 0;
        }

        /* Custom Select Styles */
        .custom-select {
            position: relative;
            display: inline-block;
            font-family: system-ui, -apple-system, sans-serif;
        }

        .select-selected {
            color: var(--cert-primary);
            font-weight: 600;
            cursor: pointer;
            padding: 0 16px 0 4px;
            position: relative;
            display: inline-block;
        }

        .select-selected:after {
            content: 'â–¼';
            font-size: 0.7em;
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
        }

        .select-items {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            z-index: 99;
            background: var(--card-background);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            margin-top: 8px;
            display: none;
            min-width: 200px;
        }

        .select-items div {
            padding: 8px 16px;
            cursor: pointer;
            color: var(--text-color);
        }

        .select-items .optgroup-label {
            font-weight: 600;
            color: var(--text-color);
            padding: 8px 12px 4px;
            font-size: 0.9em;
            cursor: default;
            background: var(--background-color);
        }

        .select-items .option-item {
            padding: 8px 24px;
        }

        .select-items .option-item:hover {
            background-color: var(--cert-bg);
            color: var(--cert-primary);
        }

        .select-hide {
            display: none;
        }

        .select-items-visible {
            display: block;
        }

        .software-section {
            background: var(--card-background);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px var(--shadow-color);
            border-left: 5px solid transparent;
            display: flex;
            gap: 20px;
        }

        .section-icon {
            flex-shrink: 0;
            width: 48px;
            height: 48px;
        }

        .section-content {
            flex-grow: 1;
        }

        /* Certificate specific styles */
        .cert-section {
            background-color: var(--cert-bg);
            border-left-color: var(--cert-primary);
        }

        .cert-section .download-button {
            background-color: var(--cert-primary);
        }

        .cert-section .download-button:hover {
            background-color: var(--cert-secondary);
        }

        .cert-section h2 {
            color: var(--cert-primary);
        }

        /* PaperCut specific styles */
        .papercut-section {
            background-color: var(--papercut-bg);
            border-left-color: var(--papercut-primary);
        }

        .papercut-section .download-button {
            background-color: var(--papercut-primary);
        }

        .papercut-section .download-button:hover {
            background-color: var(--papercut-secondary);
        }

        .papercut-section h2 {
            color: var(--papercut-primary);
        }

        /* Office specific styles */
        .office-section {
            background-color: var(--office-bg);
            border-left-color: var(--office-primary);
        }

        .office-section .download-button {
            background-color: var(--office-primary);
        }

        .office-section .download-button:hover {
            background-color: var(--office-secondary);
        }

        .office-section h2 {
            color: var(--office-primary);
        }

        .download-button {
            display: inline-block;
            color: white;
            padding: 10px 20px;
            border-radius: 4px;
            text-decoration: none;
            margin-top: 10px;
            transition: background-color 0.3s;
        }

        .instructions {
            margin-top: 15px;
        }

        .instructions ol {
            padding-left: 20px;
            margin: 0;
        }

        .faq {
            margin-top: 40px;
        }

        .faq-section {
            margin-bottom: 32px;
        }

        .faq-section-header {
            font-size: 1.2em;
            margin-bottom: 16px;
            padding-bottom: 8px;
            border-bottom: 2px solid;
            font-weight: 600;
        }

        .faq-program .faq-section-header {
            color: var(--faq-program-color);
            border-color: var(--faq-program-color);
        }

        .faq-program .faq-item {
            border-left: 3px solid var(--faq-program-color);
        }

        /* Technical section styling */
        .faq-technical .faq-section-header {
            color: var(--faq-technical-color);
            border-color: var(--faq-technical-color);
        }

        .faq-technical .faq-item {
            border-left: 3px solid var(--faq-technical-color);
        }

        .faq-item {
            margin-bottom: 12px;
            border: 1px solid var(--faq-border);
            border-radius: 8px;
            overflow: hidden;
            background-color: var(--faq-bg);
        }

        .faq-question {
            font-weight: 600;
            color: var(--cert-primary);
            padding: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: var(--faq-bg);
            color: var(--text-color);
            transition: background-color 0.2s;
        }

        .faq-question:hover {
            background-color: var(--faq-hover);
        }

        .faq-question::after {
            content: 'â€º';
            font-size: 20px;
            transform: rotate(90deg);
            transition: transform 0.3s ease;
        }

        .faq-question.collapsed::after {
            transform: rotate(0deg);
        }

        .faq-answer {
            padding: 0 16px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out, padding 0.3s ease;
            background-color: var(--faq-bg);
            color: var(--text-color);
        }

        .faq-answer.expanded {
            padding: 0 16px 16px 16px;
            max-height: 800px;
        }

        .system-info {
            background: var(--card-background);
            border-radius: 8px;
            padding: 16px 20px;
            margin-bottom: 24px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-left: 5px solid var(--cert-primary);
            display: flex;
            align-items: flex-start;
            /* Changed from align-items: center */
            gap: 12px;
        }

        .system-info svg {
            width: 24px;
            height: 24px;
            color: var(--cert-primary);
            margin-top: 2px;
            /* Added to align with the first line of text */
        }

        .system-info-text {
            font-size: 1.1em;
            color: var(--text-color);
        }

        .system-info-text strong {
            color: var(--cert-primary);
            font-weight: 600;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .section-header h2 {
            margin: 0;
        }

        .os-badge {
            display: inline-flex;
            align-items: center;
            background-color: #4b5563;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: 500;
            height: fit-content;
        }

        .hidden {
            display: none;
        }

        .arch-specific {
            display: none;
        }

        .note {
            font-size: 0.9em;
            color: #666;
            margin-top: 8px;
            font-style: italic;
        }

        .detection-note {
            font-size: 0.8em;
            color: #6b7280;
            margin-top: 4px;
            font-style: italic;
        }

        #phone-block-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 9999;
            backdrop-filter: blur(5px);
            /* Use padding to ensure content doesn't touch edges */
            padding: 20px;
            /* Improved centering with flexbox */
            display: flex;
            align-items: center;
            justify-content: center;
            box-sizing: border-box;
        }

        @media (prefers-color-scheme: dark) {
            #phone-block-modal {
                background-color: rgba(0, 0, 0, 0.95);
            }

            .modal-content {
                background-color: var(--card-background);
                color: var(--text-color);
            }
        }

        #phone-block-modal.hidden {
            display: none;
        }

        .modal-content {
            background-color: white;
            padding: 24px;
            border-radius: 8px;
            /* Set both max-width and width */
            width: 100%;
            max-width: 320px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            /* Prevent content from overflowing */
            overflow-wrap: break-word;
            margin: 0 auto;
        }

        .modal-icon {
            width: 48px;
            height: 48px;
            margin: 0 auto 16px;
            color: #dc2626;
        }

        .modal-content h2 {
            color: #dc2626;
            margin: 0 0 16px 0;
            font-size: 1.5em;
            /* Prevent text from overflowing */
            overflow-wrap: break-word;
            word-wrap: break-word;
            hyphens: auto;
        }

        .modal-content p {
            margin: 0;
            color: #4b5563;
            font-size: 1.1em;
            line-height: 1.5;
            /* Prevent text from overflowing */
            overflow-wrap: break-word;
            word-wrap: break-word;
            hyphens: auto;
        }

        .modal-message {
            display: flex;
            flex-direction: column;
            gap: 16px;
            color: #4b5563;
            font-size: 1.1em;
            line-height: 1.5;
        }

        .modal-message span {
            display: block;
        }

        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .tooltip::after {
            content: "Bring Your Own Device";
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.2s ease;
            margin-bottom: 5px;
        }

        @media (prefers-color-scheme: dark) {
            .tooltip::after {
                background: rgba(255, 255, 255, 0.9);
                color: black;
            }
        }

        .tooltip:hover::after {
            visibility: visible;
            opacity: 1;
        }

        @media (max-width: 767px) {
            .download-button {
                display: none !important;
                visibility: hidden !important;
                opacity: 0 !important;
                pointer-events: none !important;
            }
        }
    </style>
</head>

<body>
    <!-- Enhanced noscript message with accessibility -->
    <noscript>
        <div role="alert" aria-label="JavaScript requirement notice" style="
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.5);
          display: flex;
          align-items: center;
          justify-content: center;
          z-index: 9999;
        ">
            <div style="
            background: white;
            padding: 2rem;
            border-radius: 0.5rem;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            text-align: center;
            font-family: system-ui, -apple-system, sans-serif;
          ">
                <svg role="img" aria-label="Warning icon" xmlns="http://www.w3.org/2000/svg" width="48" height="48"
                    viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round" style="margin: 0 auto 1rem auto;">
                    <circle cx="12" cy="12" r="10" />
                    <line x1="12" y1="8" x2="12" y2="12" />
                    <line x1="12" y1="16" x2="12.01" y2="16" />
                </svg>
                <h2 id="noscript-title">JavaScript Required</h2>
                <p id="noscript-message">This application requires JavaScript to function. Please enable JavaScript in
                    your browser settings to
                    continue.</p>
                <p id="noscript-support">If you need assistance, please contact your on-site IT support team.</p>
            </div>
        </div>
    </noscript>

    <div id="debug-panel"
        style="display: none; position: fixed; bottom: 20px; right: 20px; font-family: system-ui, -apple-system, sans-serif; padding: 20px; border-radius: 8px; z-index: 9999; width: 400px; background: var(--card-background); border-left: 5px solid #ffb703; box-shadow: 0 2px 4px var(--shadow-color);">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
            <h2 style="margin: 0; font-size: 1.2em; color: #ffb703;">System Details</h2>
            <button onclick="closeDebugPanel()"
                style="background: none; border: none; color: var(--text-color); cursor: pointer; font-size: 18px; padding: 4px;">Ã—</button>
        </div>
        <div id="debug-content" style="display: grid; gap: 16px; color: var(--text-color); font-size: 0.9em;"></div>
    </div>

    <!-- Enhanced phone blocking modal with accessibility -->
    <div id="phone-block-modal" class="hidden" role="dialog" aria-modal="true" aria-labelledby="modal-title"
        aria-describedby="modal-description">
        <div class="modal-content">
            <div class="modal-icon" aria-hidden="true">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round" role="img"
                    aria-label="Warning icon">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="12"></line>
                    <line x1="12" y1="16" x2="12.01" y2="16"></line>
                </svg>
            </div>
            <h2 id="modal-title">Mobile Phone Access Not Allowed</h2>
            <div id="modal-description" class="modal-message">
                <span class="primary-message">Please use a computer or iPad to access the software installation
                    guide.</span>
                <span class="policy-message">Mobile phones are not supported or allowed during the school day under the
                    Electronic Devices Policy.</span>
            </div>
        </div>
    </div>

    <!-- Main content container with accessibility -->
    <main class="container" role="main">
        <header class="site-header" role="banner">
            <img src="logo.png" alt="School Logo" class="school-logo" onerror="this.classList.add('hidden')"
                aria-label="School Logo">
            <h1 class="site-title">
                Student <span class="tooltip" aria-label="BYOD - Bring Your Own Device">BYOD</span> Guide
            </h1>
        </header>

        <!-- System detection banner with accessibility -->
        <div id="os-detected" class="system-info" role="status" aria-live="polite">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" role="img" aria-label="Computer icon"
                fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <rect x="2" y="3" width="20" height="12" rx="1" />
                <rect x="3" y="4" width="18" height="10" />
                <path d="M2 15h20v2a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-2z" />
                <rect x="8" y="16" width="8" height="1" />
                <line x1="4" y1="16" x2="6" y2="16" />
                <line x1="18" y1="16" x2="20" y2="16" />
            </svg>
            <div class="system-info-text">
                <span id="os-status">Looks like you're currently using</span>
                <div class="custom-select" id="os-custom-select" role="combobox" aria-expanded="false"
                    aria-haspopup="listbox" aria-controls="os-select-options">
                    <div class="select-selected" id="selected-os" tabindex="0" role="button"
                        aria-label="Currently selected operating system">Windows (x64)</div>
                    <div id="os-select-options" class="select-items" role="listbox"
                        aria-label="Operating system options">
                        <div class="optgroup-label" role="group" aria-label="Windows options">Windows</div>
                        <div class="option-item" role="option" data-value="windows-x64" aria-selected="true">Windows
                            (x64)</div>
                        <div class="option-item" role="option" data-value="windows-arm">Windows (ARM64)</div>
                        <div class="optgroup-label" role="group" aria-label="macOS options">macOS</div>
                        <div class="option-item" role="option" data-value="mac-intel">macOS (Intel)</div>
                        <div class="option-item" role="option" data-value="mac-arm">macOS (Apple Silicon)</div>
                        <div class="optgroup-label" role="group" aria-label="Mobile options">Mobile</div>
                        <div class="option-item" role="option" data-value="ios">iPadOS</div>
                        <div class="optgroup-label" role="group" aria-label="Other options">Other</div>
                        <div class="option-item" role="option" data-value="android">Android</div>
                        <div class="option-item" role="option" data-value="chrome">ChromeOS</div>
                        <div class="option-item" role="option" data-value="linux">Linux</div>
                        <div class="option-item" role="option" data-value="other">Other OS</div>
                    </div>
                </div>
                <div class="detection-note" role="note">Note: We try our best to detect what computer you're using, if
                    we've made a mistake you can select the correct device above.</div>
            </div>
        </div>

        <!-- Unsupported OS notice with accessibility -->
        <div id="unsupported-notice" class="software-section" role="alert"
            aria-label="Unsupported operating system warning" style="display: none;">
            <div class="section-icon" aria-hidden="true">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <line x1="12" y1="8" x2="12" y2="12"></line>
                    <line x1="12" y1="16" x2="12.01" y2="16"></line>
                </svg>
            </div>
            <div class="section-content">
                <h2>Unsupported Operating System</h2>
                <p>It looks like you're using an unsupported operating system. We can't guarantee if this device will
                    function correctly on the school network.</p>
                <p>Please use one of the following supported systems:</p>
                <ul role="list">
                    <li role="listitem">Windows (x64 or ARM64)</li>
                    <li role="listitem">macOS (Intel or Apple Silicon)</li>
                    <li role="listitem">iPadOS</li>
                </ul>
            </div>
        </div>

        <!-- Internet Certificate Section with accessibility -->
        <section class="software-section cert-section" role="region" aria-labelledby="cert-section-title">
            <div class="section-icon" aria-hidden="true">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                </svg>
            </div>
            <div class="section-content">
                <!-- Windows Instructions -->
                <div class="os-specific windows">
                    <div class="section-header">
                        <h2 id="cert-section-title">Internet Certificate</h2>
                        <span class="os-badge" role="status">Windows</span>
                    </div>
                    <div class="instructions" role="list" aria-label="Certificate installation instructions">
                        <ol>
                            <li role="listitem">Download the certificate file</li>
                            <li role="listitem">Double-click the downloaded certificate file</li>
                            <li role="listitem">Click "Install Certificate"</li>
                            <li role="listitem">Select "Local Machine" and click "Next"</li>
                            <li role="listitem">Select "Place all certificates in the following store" and click
                                "Browse"</li>
                            <li role="listitem">Select "Trusted Root Certification Authorities" and click "OK"</li>
                            <li role="listitem">Click "Next" and then "Finish"</li>
                        </ol>
                        <div class="arch-specific windows-x64">
                            <a href="#" class="download-button" role="button"
                                aria-label="Download Certificate for Windows x64">Download Certificate (x64)</a>
                        </div>
                        <div class="arch-specific windows-arm">
                            <a href="#" class="download-button" role="button"
                                aria-label="Download Certificate for Windows ARM64">Download Certificate (ARM64)</a>
                        </div>
                    </div>
                </div>

                <!-- macOS Instructions -->
                <div class="os-specific macos">
                    <div class="section-header">
                        <h2>Internet Certificate</h2>
                        <span class="os-badge" role="status">macOS</span>
                    </div>
                    <div class="instructions" role="list" aria-label="Certificate installation instructions for macOS">
                        <ol>
                            <li role="listitem">Download the certificate file</li>
                            <li role="listitem">Double-click the downloaded certificate file</li>
                            <li role="listitem">Select "System" in the Keychain dropdown</li>
                            <li role="listitem">Click "Add"</li>
                            <li role="listitem">Enter your administrator password</li>
                            <li role="listitem">Double-click the certificate in Keychain Access</li>
                            <li role="listitem">Expand the "Trust" section and set "When using this certificate" to
                                "Always Trust"</li>
                        </ol>
                        <div class="arch-specific mac-intel">
                            <a href="#" class="download-button" role="button"
                                aria-label="Download Certificate for Intel Mac">Download Certificate (Intel)</a>
                        </div>
                        <div class="arch-specific mac-arm">
                            <a href="#" class="download-button" role="button"
                                aria-label="Download Certificate for Apple Silicon Mac">
                                Download Certificate (Apple Silicon)</a>
                        </div>
                    </div>
                </div>

                <!-- iPadOS Instructions -->
                <div class="os-specific ios">
                    <div class="section-header">
                        <h2>Internet Certificate</h2>
                        <span class="os-badge" role="status">iPadOS</span>
                    </div>
                    <div class="instructions" role="list" aria-label="Certificate installation instructions for iPadOS">
                        <ol>
                            <li role="listitem">Download the configuration profile</li>
                            <li role="listitem">Go to Settings</li>
                            <li role="listitem">Tap on "Profile Downloaded"</li>
                            <li role="listitem">Tap "Install" in the top right corner</li>
                            <li role="listitem">Enter your device passcode</li>
                            <li role="listitem">Tap "Install" again to confirm</li>
                        </ol>
                        <a href="#" class="download-button" role="button"
                            aria-label="Download Certificate for iPadOS">Download Certificate for iPadOS</a>
                    </div>
                </div>
            </div>
        </section>
        <!-- PaperCut Client Section with accessibility -->
        <section class="software-section papercut-section" role="region" aria-labelledby="papercut-section-title">
            <div class="section-icon" aria-hidden="true">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" />
                    <circle cx="9" cy="7" r="4" />
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87" />
                    <path d="M16 3.13a4 4 0 0 1 0 7.75" />
                </svg>
            </div>
            <div class="section-content">
                <!-- Windows Instructions -->
                <div class="os-specific windows">
                    <div class="section-header">
                        <h2 id="papercut-section-title">PaperCut Client</h2>
                        <span class="os-badge" role="status">Windows</span>
                    </div>
                    <div class="instructions" role="list" aria-label="PaperCut installation instructions for Windows">
                        <ol>
                            <li role="listitem">Download the PaperCut Client installer for your architecture</li>
                            <li role="listitem">Run the installer as administrator</li>
                            <li role="listitem">Follow the installation wizard</li>
                            <li role="listitem">Click "Finish" to complete installation</li>
                        </ol>
                        <div class="arch-specific windows-x64">
                            <a href="#" class="download-button" role="button"
                                aria-label="Download PaperCut for Windows x64">Download PaperCut (x64)</a>
                        </div>
                        <div class="arch-specific windows-arm">
                            <a href="#" class="download-button" role="button"
                                aria-label="Download PaperCut for Windows ARM64">Download PaperCut (ARM64)</a>
                            <p class="note" role="note">Note: ARM64 version runs through Windows' x86 emulation</p>
                        </div>
                    </div>
                </div>

                <!-- iPadOS Instructions -->
                <div class="os-specific ios">
                    <div class="section-header">
                        <h2>PaperCut Client</h2>
                        <span class="os-badge" role="status">iPadOS</span>
                    </div>
                    <div class="instructions" aria-label="PaperCut printing information for iPadOS">
                        <p>iPadOS & iOS are able to print without the papercut client.<br>Simply print like normal and
                            select the Virtual Queue.</p>
                    </div>
                </div>

                <!-- macOS Instructions -->
                <div class="os-specific macos">
                    <div class="section-header">
                        <h2>PaperCut Client</h2>
                        <span class="os-badge" role="status">macOS</span>
                    </div>
                    <div class="instructions" role="list" aria-label="PaperCut installation instructions for macOS">
                        <ol>
                            <li role="listitem">Download the PaperCut Client DMG file</li>
                            <li role="listitem">Open the DMG file</li>
                            <li role="listitem">Drag PaperCut Client to Applications folder</li>
                            <li role="listitem">Launch PaperCut Client from Applications</li>
                        </ol>
                        <div class="arch-specific mac-intel">
                            <a href="#" class="download-button" role="button"
                                aria-label="Download PaperCut for Intel Mac">Download PaperCut (Intel)</a>
                        </div>
                        <div class="arch-specific mac-arm">
                            <a href="#" class="download-button" role="button"
                                aria-label="Download PaperCut for Apple Silicon Mac">Download PaperCut (Apple
                                Silicon)</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Microsoft Office Section with accessibility -->
        <section class="software-section office-section" role="region" aria-labelledby="office-section-title">
            <div class="section-icon" aria-hidden="true">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" />
                    <polyline points="22,6 12,13 2,6" />
                </svg>
            </div>
            <div class="section-content">
                <!-- Windows Instructions -->
                <div class="os-specific windows">
                    <div class="section-header">
                        <h2 id="office-section-title">Microsoft Office</h2>
                        <span class="os-badge" role="status">Windows</span>
                    </div>
                    <div class="instructions" role="list"
                        aria-label="Microsoft Office installation instructions for Windows">
                        <ol>
                            <li role="listitem">Sign in to Office 365 portal</li>
                            <li role="listitem">Click "Install Office"</li>
                            <li role="listitem">Run the downloaded installer</li>
                            <li role="listitem">Sign in with your organization account</li>
                        </ol>
                        <div class="arch-specific windows-x64">
                            <a href="https://www.office.com/" class="download-button" role="button"
                                aria-label="Go to Office 365 Portal for Windows x64">Go to Office 365 Portal (x64)</a>
                        </div>
                        <div class="arch-specific windows-arm">
                            <a href="https://www.office.com/" class="download-button" role="button"
                                aria-label="Go to Office 365 Portal for Windows ARM64">Go to Office 365 Portal
                                (ARM64)</a>
                            <p class="note" role="note">Note: Make sure to select ARM64 version during installation</p>
                        </div>
                    </div>
                </div>

                <!-- macOS Instructions -->
                <div class="os-specific macos">
                    <div class="section-header">
                        <h2>Microsoft Office</h2>
                        <span class="os-badge" role="status">macOS</span>
                    </div>
                    <div class="instructions" role="list"
                        aria-label="Microsoft Office installation instructions for macOS">
                        <ol>
                            <li role="listitem">Sign in to Office 365 portal</li>
                            <li role="listitem">Click "Install Office"</li>
                            <li role="listitem">Open the downloaded package</li>
                            <li role="listitem">Follow the installation wizard</li>
                            <li role="listitem">Sign in with your organization account</li>
                        </ol>
                        <div class="arch-specific mac-intel">
                            <a href="https://www.office.com/" class="download-button" role="button"
                                aria-label="Go to Office 365 Portal for Intel Mac">Go to Office 365 Portal (Intel)</a>
                        </div>
                        <div class="arch-specific mac-arm">
                            <a href="https://www.office.com/" class="download-button" role="button"
                                aria-label="Go to Office 365 Portal for Apple Silicon Mac">Go to Office 365 Portal
                                (Apple Silicon)</a>
                            <p class="note" role="note">Note: Office automatically detects and installs the appropriate
                                version</p>
                        </div>
                    </div>
                </div>

                <!-- iPadOS Instructions -->
                <div class="os-specific ios">
                    <div class="section-header">
                        <h2>Microsoft Office</h2>
                        <span class="os-badge" role="status">iPadOS</span>
                    </div>
                    <div class="instructions" role="list"
                        aria-label="Microsoft Office installation instructions for iPadOS">
                        <ol>
                            <li role="listitem">Open App Store</li>
                            <li role="listitem">Search for Microsoft Office apps</li>
                            <li role="listitem">Download required apps (Word, Excel, etc.)</li>
                            <li role="listitem">Open any Office app and sign in with your organization account</li>
                        </ol>
                        <a href="https://apps.apple.com/us/app/microsoft-office/id541164041" class="download-button"
                            role="button" aria-label="View Microsoft Office in App Store">View in App Store</a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Complete FAQ Section with all questions -->
        <div class="faq-section faq-program" role="region" aria-labelledby="faq-program-header">
            <h3 id="faq-program-header" class="faq-section-header">Program Information & School Support</h3>

            <div class="faq-item" role="group">
                <div class="faq-question" role="button" aria-expanded="true" aria-controls="faq-answer-1" tabindex="0">
                    When it comes to the technical support side of BYOD, what is the school able to help with?
                </div>
                <div id="faq-answer-1" class="faq-answer expanded" role="region">
                    The school's IT department is responsible for:
                    <ol role="list">
                        <li role="listitem">Helping you connect your (compatible) BYOD device to the school internet.
                        </li>
                        <li role="listitem">Providing instructions to get setup with the Department of Education
                            provided copy of
                            Microsoft Office (Word, PowerPoint, Excel) so you're ready to use the most common
                            software at school.</li>
                        <li role="listitem">Giving you the ability to print at school using the PaperCut software. Just
                            remember you
                            have a monetary limit each term, and reaching this limit means you can't print until the
                            following term.</li>
                    </ol>
                </div>
            </div>

            <div class="faq-item" role="group">
                <div class="faq-question collapsed" role="button" aria-expanded="false" aria-controls="faq-answer-2"
                    tabindex="0">
                    I've lost or accidentally deleted my work. Can you help?
                </div>
                <div id="faq-answer-2" class="faq-answer" role="region">
                    Students are responsible for safely and securely saving their school work.
                    The school IT Department isn't able to help you recover any lost work.<br><br>
                    We recommend you save your work in the provided OneDrive storage solution, this way you can turn
                    on autosave and access your work from another computer if you forget or damage your BYOD device.
                </div>
            </div>

            <div class="faq-item" role="group">
                <div class="faq-question collapsed" role="button" aria-expanded="false" aria-controls="faq-answer-3"
                    tabindex="0">
                    There is something wrong with my device and it isn't working correctly.
                </div>
                <div id="faq-answer-3" class="faq-answer" role="region">
                    Like with physical issues the school's IT department isn't able to assist with any issues that may
                    arise
                    from non-school software such as antivirus or third party software.<br><br>
                    If these issues are stopping you from completing school work we have a limited number of short-term
                    loan
                    laptops you can borrow for the day.
                </div>
            </div>

            <div class="faq-item" role="group">
                <div class="faq-question collapsed" role="button" aria-expanded="false" aria-controls="faq-answer-4"
                    tabindex="0">
                    My BYOD device was damaged. Can you fix it?
                </div>
                <div id="faq-answer-4" class="faq-answer" role="region">
                    BYOD devices aren't covered under the school's insurance policy. As they're personal devices it's
                    your
                    responsibility for the maintenance and upkeep. We recommend you look at the manufacturers warranty
                    options
                    as well as home/personal insurance to cover the device.<br><br>
                    If you suspect foul play in the damage of a device, the school's Student Services team will do their
                    best
                    to assist you.
                </div>
            </div>

            <div class="faq-item" role="group">
                <div class="faq-question collapsed" role="button" aria-expanded="false" aria-controls="faq-answer-5"
                    tabindex="0">
                    What happens to the free software the school provides when I leave?
                </div>
                <div id="faq-answer-5" class="faq-answer" role="region">
                    Microsoft Office and any other software provided by the school is provided for free by the
                    Department of
                    Education under the condition you're a currently enrolled student.<br><br>
                    If you move to a non-public school, interstate or finish your schooling the software license will be
                    automatically revoked. You will have the option after this to uninstall the software or purchase a
                    license directly from Microsoft to continue using the product.<br><br>
                    <i>KEEP IN MIND: Any documents saved in OneDrive will be automatically deleted at the end of your
                        schooling for security reasons. We recommend moving these files to an external USB or another
                        place
                        on the computer if you wish to maintain access to them.</i>
                </div>
            </div>
        </div>

        <!-- Technical Information Section -->
        <div class="faq-section faq-technical" role="region" aria-labelledby="faq-technical-header">
            <h3 id="faq-technical-header" class="faq-section-header">Technical Details & Requirements</h3>

            <div class="faq-item" role="group">
                <div class="faq-question" role="button" aria-expanded="true" aria-controls="faq-answer-tech-1"
                    tabindex="0">
                    What devices and operating systems are officially supported?
                </div>
                <div id="faq-answer-tech-1" class="faq-answer expanded" role="region">
                    <div id="supported-versions">We officially support:
                        <ul role="list">
                            <li role="listitem"><strong>Windows <span id="windows-version">10</span></strong>:
                                Microsoft's current operating system receiving regular updates.</li>
                            <li role="listitem"><strong>macOS <span id="macos-version">14</span>+</strong>:
                                Apple's oldest desktop class operating system currently supported.</li>
                            <li role="listitem"><strong>iPadOS <span id="ipados-version">17</span>+</strong>:
                                Apple's oldest supported mobile operating system.</li>
                        </ul>
                        These platforms are supported because they:
                        <ul role="list">
                            <li role="listitem">Have been confirmed to work within our schools Enterprise Network</li>
                            <li role="listitem">Are still receiving regular security updates</li>
                            <li role="listitem">Support stable, tested versions of all required software</li>
                        </ul>
                        Older versions of these operating systems are not supported as they no longer receive security
                        updates.
                        Other platforms (Android, ChromeOS, Linux) aren't officially supported as they are not
                        compatible with
                        our network infrastructure.
                    </div>
                </div>
            </div>

            <div class="faq-item" role="group">
                <div class="faq-question collapsed" role="button" aria-expanded="false"
                    aria-controls="faq-answer-tech-2" tabindex="0">
                    Why do I need to install the Internet Certificate?
                </div>
                <div id="faq-answer-tech-2" class="faq-answer" role="region">
                    The Internet Certificate ensures secure connection to organizational resources and internal
                    websites.
                    Without it, you may experience security warnings or connection issues.
                </div>
            </div>

            <div class="faq-item" role="group">
                <div class="faq-question collapsed" role="button" aria-expanded="false"
                    aria-controls="faq-answer-tech-3" tabindex="0">
                    Do I need to install PaperCut on my mobile device?
                </div>
                <div id="faq-answer-tech-3" class="faq-answer" role="region">
                    No, PaperCut Client is only required for desktop computers (Windows and macOS). Mobile printing is
                    handled through different methods.
                </div>
            </div>

            <div class="faq-item" role="group">
                <div class="faq-question collapsed" role="button" aria-expanded="false"
                    aria-controls="faq-answer-tech-4" tabindex="0">
                    Can I install Microsoft Office on multiple devices?
                </div>
                <div id="faq-answer-tech-4" class="faq-answer" role="region">
                    Yes, with your organization account, you can install Microsoft Office on up to 5 devices
                    simultaneously.
                </div>
            </div>

            <div class="faq-item" role="group">
                <div class="faq-question collapsed" role="button" aria-expanded="false"
                    aria-controls="faq-answer-tech-5" tabindex="0">
                    What should I do if I get an error during installation?
                </div>
                <div id="faq-answer-tech-5" class="faq-answer" role="region">
                    First, try restarting your device and running the installer again. If the issue persists, contact IT
                    Support for assistance.
                </div>
            </div>

            <div class="faq-item" role="group">
                <div class="faq-question collapsed" role="button" aria-expanded="false"
                    aria-controls="faq-answer-tech-6" tabindex="0">
                    Do I need administrator rights to install these applications?
                </div>
                <div id="faq-answer-tech-6" class="faq-answer" role="region">
                    Yes, you need administrator rights to install the certificate and PaperCut Client. For Microsoft
                    Office,
                    standard user rights are sufficient.
                </div>
            </div>
        </div>
        </section>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Add debug panel to DOM
            const debugPanel = document.createElement('div');
            debugPanel.id = 'debug-panel';
            debugPanel.style.cssText = 'display: none; position: fixed; bottom: 20px; right: 20px; font-family: system-ui, -apple-system, sans-serif; padding: 20px; border-radius: 8px; z-index: 9999; max-width: 400px; background: var(--card-background); border-left: 5px solid var(--cert-primary); box-shadow: 0 2px 4px var(--shadow-color);';
            debugPanel.innerHTML = `
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
        <h2 style="margin: 0; font-size: 1.2em; color: var(--cert-primary);">System Details</h2>
        <button onclick="closeDebugPanel()" style="background: none; border: none; color: var(--text-color); cursor: pointer; font-size: 18px; padding: 4px;">Ã—</button>
    </div>
    <div id="debug-content" style="font-size: 0.9em; line-height: 1.5; color: var(--text-color); white-space: pre-wrap; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;"></div>
`;
            document.body.appendChild(debugPanel);

            // Konami Code implementation
            const KONAMI_CODE = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight'];
            let currentSequence = [];

            // Debug panel functions
            window.closeDebugPanel = function () {
                document.getElementById('debug-panel').style.display = 'none';
            };

            async function formatSystemInfo() {
                // Get the current OS value from our select element
                const currentOS = document.querySelector('.select-selected').textContent;

                // Create each section as a div
                const createSection = (title, items) => `
        <div>
            <div style="font-weight: 600; color: #ffb703; margin-bottom: 8px;">${title}</div>
            <div style="display: grid; gap: 4px;">
                ${items.map(item => `<div>${item}</div>`).join('')}
            </div>
        </div>
    `;

                // Device & OS Section
                const deviceSection = createSection('Device & OS', [
                    `Operating System: ${currentOS}`,
                    `User Agent: ${navigator.userAgent}`
                ]);

                // Display Section
                const displaySection = createSection('Display', [
                    `Screen Resolution: ${window.screen.width}x${window.screen.height}`,
                    `Window Size: ${window.innerWidth}x${window.innerHeight}`,
                    `Pixel Ratio: ${window.devicePixelRatio}`,
                    `Color Depth: ${window.screen.colorDepth}-bit`
                ]);

                // Hardware Section
                const hardwareItems = [];
                if (navigator.hardwareConcurrency) {
                    hardwareItems.push(`CPU Cores: ${navigator.hardwareConcurrency}`);
                }
                if (navigator.deviceMemory) {
                    hardwareItems.push(`System Memory: ${navigator.deviceMemory}GB`);
                }
                hardwareItems.push(`Touch Points: ${navigator.maxTouchPoints}`);

                // Add GPU info
                try {
                    const canvas = document.createElement('canvas');
                    const gl = canvas.getContext('webgl2');
                    if (gl) {
                        const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                        if (debugInfo) {
                            hardwareItems.push(`GPU: ${gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL)}`);
                            hardwareItems.push(`GPU Vendor: ${gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL)}`);
                        }
                    }
                } catch (e) {
                    hardwareItems.push('GPU: Unable to detect');
                }

                const hardwareSection = createSection('Hardware', hardwareItems);

                // System Settings Section
                const settingsItems = [];

                // Network Information
                if ('connection' in navigator && navigator.connection) {
                    const conn = navigator.connection;
                    const networkInfo = [];

                    // Add connection type if available
                    if (conn.type && conn.type !== 'unknown') {
                        networkInfo.push(conn.type);
                    }

                    // Add bandwidth and latency if available, noting maximums
                    if (conn.downlink) {
                        networkInfo.push(`${conn.downlink} Mb/s${conn.downlink === 10 ? ' (max)' : ''}`);
                    }
                    if (conn.rtt) {
                        networkInfo.push(`${conn.rtt}ms latency${conn.rtt === 250 ? ' (max)' : ''}`);
                    }

                    if (networkInfo.length > 0) {
                        settingsItems.push(`Network: ${networkInfo.join(', ')}`);
                    } else {
                        settingsItems.push(`Network: ${navigator.onLine ? 'Connected' : 'Offline'}`);
                    }
                } else {
                    settingsItems.push(`Network: ${navigator.onLine ? 'Connected' : 'Offline'}`);
                }

                // Add remaining system settings
                settingsItems.push(`Language: ${navigator.language}`);
                settingsItems.push(`Cookies: ${navigator.cookieEnabled ? 'Enabled' : 'Disabled'}`);

                const settingsSection = createSection('System Settings', settingsItems);

                return deviceSection + displaySection + hardwareSection + settingsSection;
            }

            async function getConnectionInfo() {
                if ('connection' in navigator) {
                    const conn = navigator.connection;
                    return {
                        type: conn.type, // ethernet, wifi, cellular, etc.
                        effectiveType: conn.effectiveType, // 4g, 3g, etc.
                        downlink: conn.downlink, // Mb/s
                        rtt: conn.rtt // Round trip time in ms
                    };
                }
                // Fallback to basic online/offline
                return {
                    type: navigator.onLine ? 'connected' : 'offline'
                };
            }

            async function showDebugPanel() {
                const panel = document.getElementById('debug-panel');
                const content = document.getElementById('debug-content');

                content.innerHTML = await formatSystemInfo();

                panel.style.display = 'block';
                panel.style.opacity = '0';
                setTimeout(() => {
                    panel.style.transition = 'opacity 0.3s ease-in-out';
                    panel.style.opacity = '1';
                }, 10);
            }

            // Listen for Konami code
            document.addEventListener('keydown', (e) => {
                currentSequence.push(e.key);
                if (currentSequence.length > KONAMI_CODE.length) {
                    currentSequence.shift();
                }
                if (currentSequence.join(',') === KONAMI_CODE.join(',')) {
                    showDebugPanel();
                    currentSequence = [];
                }
            });

            // Original website functionality
            const customSelect = document.getElementById('os-custom-select');
            const selectSelected = customSelect.querySelector('.select-selected');
            const selectItems = customSelect.querySelector('.select-items');
            const options = selectItems.querySelectorAll('.option-item');

            // Toggle dropdown
            selectSelected.addEventListener('click', function (e) {
                e.stopPropagation();
                selectItems.classList.toggle('select-items-visible');
                selectSelected.classList.toggle('select-arrow-active');
            });

            // Handle option selection
            options.forEach(option => {
                option.addEventListener('click', function (e) {
                    const value = this.getAttribute('data-value');
                    const text = this.textContent;

                    // Update selected text
                    selectSelected.textContent = text;

                    // Close dropdown
                    selectItems.classList.remove('select-items-visible');

                    // Update display
                    updateDisplay(value);
                });
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', function (e) {
                if (!customSelect.contains(e.target)) {
                    selectItems.classList.remove('select-items-visible');
                }
            });

            async function detectSystem() {
                const userAgent = navigator.userAgent.toLowerCase();
                const platform = navigator.platform.toLowerCase();
                let osValue = "windows-x64"; // Default value
                let displayText = "Windows (x64)"; // Default display text
                let isUnsupported = false;

                // Improved iOS detection first
                const isIOS = /iphone|ipad|ipod/.test(userAgent) ||
                    (platform === 'iphone') ||
                    (platform === 'ipad') ||
                    (platform === 'ipod') ||
                    (navigator.maxTouchPoints > 0 &&
                        /mac/.test(platform) &&
                        /apple/.test(navigator.vendor));

                if (isIOS) {
                    osValue = "ios";
                    displayText = "iPadOS";
                }
                else if (userAgent.includes("win")) {
                    if (userAgent.includes("arm64") || userAgent.includes("aarch64")) {
                        osValue = "windows-arm";
                        displayText = "Windows (ARM64)";
                    } else {
                        osValue = "windows-x64";
                        displayText = "Windows (x64)";
                    }
                }
                else if (userAgent.includes("mac")) {
                    async function isMacAppleSilicon() {
                        if (!platform.includes('mac')) {
                            return false;
                        }

                        if ('deviceMemory' in navigator) {
                            return navigator.deviceMemory >= 8;
                        }

                        if (typeof performance !== 'undefined' && performance.memory) {
                            return performance.memory.jsHeapSizeLimit > 4000000000;
                        }

                        const start = performance.now();
                        let result = 0;
                        for (let i = 0; i < 1000000; i++) {
                            result += Math.sqrt(i);
                        }
                        const duration = performance.now() - start;

                        return duration < 15;
                    }

                    const isAppleSilicon = await isMacAppleSilicon();

                    if (isAppleSilicon) {
                        osValue = "mac-arm";
                        displayText = "macOS (Apple Silicon)";
                    } else {
                        osValue = "mac-intel";
                        displayText = "macOS (Intel)";
                    }
                }
                else if (userAgent.includes("android")) {
                    osValue = "android";
                    displayText = "Android";
                    isUnsupported = true;
                }
                else if (userAgent.includes("cros")) {
                    osValue = "chrome";
                    displayText = "ChromeOS";
                    isUnsupported = true;
                }
                else if (userAgent.includes("linux")) {
                    osValue = "linux";
                    displayText = "Linux";
                    isUnsupported = true;
                }
                else {
                    osValue = "other";
                    displayText = "Other OS";
                    isUnsupported = true;
                }

                // Update the custom select display
                const selectSelected = document.querySelector('.select-selected');
                if (selectSelected) {
                    selectSelected.textContent = displayText;
                }

                // Update the status text and unsupported notice
                const osStatus = document.getElementById('os-status');
                if (osStatus) {
                    osStatus.textContent = isUnsupported ? "Detected unsupported system:" : "Looks like you're currently using";
                }

                const unsupportedNotice = document.getElementById('unsupported-notice');
                if (unsupportedNotice) {
                    unsupportedNotice.style.display = isUnsupported ? 'flex' : 'none';
                }

                // Update the visible sections
                updateDisplay(osValue);
            }

            function updateDisplay(osValue) {
                const isUnsupported = ['android', 'chrome', 'linux', 'other'].includes(osValue);

                // Show/hide unsupported notice
                document.getElementById('unsupported-notice').style.display = isUnsupported ? 'flex' : 'none';
                document.getElementById('os-status').textContent = isUnsupported ? "Detected unsupported system:" : "Looks like you're currently using";

                // Show/hide all software sections
                document.querySelectorAll('.software-section').forEach(el => {
                    if (el.id !== 'unsupported-notice') {
                        el.style.display = isUnsupported ? 'none' : 'flex';
                    }
                });

                if (!isUnsupported) {
                    // Hide all OS-specific sections first
                    document.querySelectorAll('.os-specific').forEach(el => {
                        el.classList.add('hidden');
                    });

                    // Hide all architecture-specific elements
                    document.querySelectorAll('.arch-specific').forEach(el => {
                        el.style.display = 'none';
                    });

                    // Show relevant sections based on OS and architecture
                    if (osValue === 'windows-x64') {
                        document.querySelectorAll('.windows').forEach(el => {
                            el.classList.remove('hidden');
                        });
                        document.querySelectorAll('.windows-x64').forEach(el => {
                            el.style.display = 'block';
                        });
                    } else if (osValue === 'windows-arm') {
                        document.querySelectorAll('.windows').forEach(el => {
                            el.classList.remove('hidden');
                        });
                        document.querySelectorAll('.windows-arm').forEach(el => {
                            el.style.display = 'block';
                        });
                    } else if (osValue.startsWith('mac')) {
                        document.querySelectorAll('.macos').forEach(el => {
                            el.classList.remove('hidden');
                        });
                        document.querySelectorAll(`.${osValue}`).forEach(el => {
                            el.style.display = 'block';
                        });
                    } else if (osValue === 'ios') {
                        document.querySelectorAll('.ios').forEach(el => {
                            el.classList.remove('hidden');
                        });
                    }
                }
            }

            function detectPhone() {
                const userAgent = navigator.userAgent.toLowerCase();
                const platform = navigator.platform;

                const isIOS = /iphone|ipod|ipad/.test(userAgent) ||
                    (platform === 'MacIntel' && navigator.maxTouchPoints > 0);

                const isAndroid = /android/.test(userAgent);

                if (!isIOS && !isAndroid) return false;

                const isIPad =
                    /ipad/.test(userAgent) ||
                    /iPad|Macintosh/.test(navigator.platform) ||
                    (platform === 'MacIntel' && navigator.maxTouchPoints > 0 && !/iPhone/.test(userAgent)) ||
                    /iPad/.test(navigator.platform) ||
                    (navigator.maxTouchPoints > 0 && /Mac/.test(platform) && !/iPhone/.test(userAgent));

                const screenWidth = window.innerWidth;
                const screenHeight = window.innerHeight;
                const smallerDimension = Math.min(screenWidth, screenHeight);
                const largerDimension = Math.max(screenWidth, screenHeight);

                const isPhoneSize = (
                    smallerDimension < 600 ||
                    largerDimension < 900 ||
                    (largerDimension / smallerDimension > 1.7 && smallerDimension < 800)
                );

                const isTabletSize = (
                    largerDimension >= 900 &&
                    smallerDimension >= 600 &&
                    (largerDimension / smallerDimension <= 1.7 || smallerDimension >= 750)
                );

                return (isIOS && !isIPad) || (isAndroid && !isTabletSize);
            }

            function updateBlockerMessage(isAndroid) {
                const primaryMessage = document.querySelector('.modal-message .primary-message');
                const policyMessage = document.querySelector('.modal-message .policy-message');

                primaryMessage.textContent = 'Please use a computer or iPad to access the Student BYOD Guide.';
                policyMessage.textContent = 'Mobile phones are not supported or allowed during the school day under the Electronic Devices Policy.';
            }

            function checkAndBlockDevice() {
                const isPhone = detectPhone();
                const isAndroid = /android/.test(navigator.userAgent.toLowerCase());
                const modal = document.getElementById('phone-block-modal');
                const downloadButtons = document.querySelectorAll('.download-button');

                if (isPhone) {
                    modal.classList.remove('hidden');
                    document.body.style.overflow = 'hidden';
                    document.body.style.position = 'fixed';
                    document.body.style.width = '100%';
                    document.body.style.height = '100%';
                    document.body.style.touchAction = 'none';

                    downloadButtons.forEach(button => {
                        button.style.display = 'none';
                    });

                    const buttonObserver = new MutationObserver((mutations) => {
                        mutations.forEach((mutation) => {
                            if (mutation.type === 'attributes' &&
                                (mutation.attributeName === 'style' ||
                                    mutation.attributeName === 'class')) {
                                const element = mutation.target;
                                if (element.classList.contains('download-button')) {
                                    element.style.display = 'none';
                                }
                            }
                        });
                    });

                    downloadButtons.forEach(button => {
                        buttonObserver.observe(button, {
                            attributes: true,
                            attributeFilter: ['style', 'class']
                        });
                    });

                    const container = document.querySelector('.container');
                    const containerObserver = new MutationObserver((mutations) => {
                        mutations.forEach((mutation) => {
                            mutation.addedNodes.forEach((node) => {
                                if (node.nodeType === 1) {
                                    const newButtons = node.querySelectorAll('.download-button');
                                    newButtons.forEach(button => {
                                        button.style.display = 'none';
                                        buttonObserver.observe(button, {
                                            attributes: true,
                                            attributeFilter: ['style', 'class']
                                        });
                                    });
                                }
                            });
                        });
                    });

                    containerObserver.observe(container, {
                        childList: true,
                        subtree: true
                    });

                } else {
                    modal.classList.add('hidden');
                    document.body.style.overflow = '';
                    document.body.style.position = '';
                    document.body.style.width = '';
                    document.body.style.height = '';
                    document.body.style.touchAction = '';

                    downloadButtons.forEach(button => {
                        button.style.display = 'inline-block';
                    });
                }
            }

            // Event listeners for phone detection
            window.addEventListener('resize', checkAndBlockDevice);
            window.addEventListener('orientationchange', () => setTimeout(checkAndBlockDevice, 100));
            document.addEventListener('visibilitychange', checkAndBlockDevice);
            setInterval(checkAndBlockDevice, 2000);

            // Additional check for orientation changes through resize
            let lastWidth = window.innerWidth;
            window.addEventListener('resize', function () {
                if (window.innerWidth !== lastWidth) {
                    lastWidth = window.innerWidth;
                    checkAndBlockDevice();
                }
            });

            // Prevent modal from being removed
            const observer = new MutationObserver((mutations) => {
                mutations.forEach((mutation) => {
                    if (mutation.type === 'childList' && !document.contains(document.getElementById('phone-block-modal'))) {
                        document.body.appendChild(modal.cloneNode(true));
                    }
                });
            });

            observer.observe(document.body, {
                childList: true,
                subtree: true
            });

            // FAQ Functionality
            document.querySelectorAll('.faq-question').forEach(question => {
                question.addEventListener('click', () => {
                    question.classList.toggle('collapsed');
                    const answer = question.nextElementSibling;
                    answer.classList.toggle('expanded');
                });
            });

            // OS Version calculations
            function calculateOSVersions() {
                const baseVersions = {
                    macOS: 14,
                    iPadOS: 17,
                    windows: 10
                };

                const sept2025 = new Date('2025-09-01');
                const currentDate = new Date();

                const yearsSince2024 = Math.floor((currentDate - new Date('2024-09-01')) / (365.25 * 24 * 60 * 60 * 1000));

                return {
                    macOS: baseVersions.macOS + Math.max(0, yearsSince2024),
                    iPadOS: baseVersions.iPadOS + Math.max(0, yearsSince2024),
                    windows: currentDate >= sept2025 ? 11 : 10
                };
            }

            function updateOSVersions() {
                const versions = calculateOSVersions();

                document.getElementById('windows-version').textContent = versions.windows;
                document.getElementById('macos-version').textContent = versions.macOS;
                document.getElementById('ipados-version').textContent = versions.iPadOS;
            }

            // Run all initializations
            detectSystem();
            checkAndBlockDevice();
            updateOSVersions();
        });

    </script>
</body>

</html>
